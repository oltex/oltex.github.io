---
title: "반복자(Iterator)"
categories:
  - design pattern
tags:
  - tag
---
> ## 개요

행동 디자인 패턴중 하나인 반복자 패턴입니다.<br>
어떤  집합 객체에 대해 내부를 노출하지 않고 속한 원소들을 접근할 수 있는 방법을 제공합니다.<br>
<br>
리스트, 스택, 트리 등을 노출하지 않고 하나씩 순회할 수 있도록 합니다.
> ## 필요성

자료를 보관하기 위해 보통 리스트, 스택, 트리 같은 컬렉션을 사용하는 것이 보편적입니다.<br>
사용자가 자료를 사용하기 위해서는 요소들에게 접근할 수 있는 방법들을 제공해야 합니다.<br>
<br>
접근 방법으로 순차 탐색등 여러가지 존재 할 수 있지만,<br>
때에 따라서 그 방식을 달리하고 싶다고 합니다.<br>
순차, 깊이 탐색등이나, 혹은 어떤 필터를 적용하여 걸러진 데이터만 탐색 하고싶다고 합니다.<br>
<br>
허나 이런 방식의 탐색을 컬렉션에 집어넣는다는 것은<br>
컬렉션의 정체성이 모호해지는 결과를 초래합니다.<br>
<br>
반면 클라이언트 코드는 컬렉션의 저장요소에 관심있을 뿐<br>
컬렉션의 탐색에 관심을 두지 않습니다.
> ## 구현

반복자 패턴은 컬렉션과 클라이언트 코드와 별도의 객체로 분리하여<br>
컬렉션을 탐색하는 방법을 제공합니다.

예시로 컬렉션을 사용하여 숫자를 저장하고 이를 순회하는 코드입니다.

먼저 List객체를 만들어 데이터를 저장하고
Iterator 인터페이스 클래스를 제작합니다.
그 다음 첫번째 원소부터 순회하는 FirstIterator객체를 만들어 List객체를 연결시킨 후
순회를 시작합니다.

```cpp
class List final {
public:
	List(std::vector<int> vector) {
		_size = vector.size();
		_arr = new int[_size];
		for (int i = 0; i < _size; ++i)
			_arr[i] = vector[i];
	}
	int Size(void) {
		return _size;
	}
	int operator[](int _index) {
		return _arr[_index];
	}
private:
	int* _arr = nullptr;
	int _size = 0;
};

class Iterator abstract {
public:
	virtual int operator*(void) = 0;
	virtual void operator++(void) = 0;
	virtual bool Size(void) = 0;
};
class FirstIterator final : public Iterator {
public:
	FirstIterator(List* list) :
		_list(list) {
	}
	virtual int operator*(void) override {
		return (*_list)[_index];
	}
	virtual void operator++(void) override {
		++_index;
	};
	virtual bool Size(void) override {
		if (_list->Size() <= _index)
			return false;
		return true;
	};
private:
	List* _list = nullptr;
	int _index = 0;
};

class LastIterator final : public Iterator {
public:
	LastIterator(List* list) :
		_list(list), _index(list->Size() - 1) {
	}
	virtual int operator*(void) override {
		return (*_list)[_index];
	}
	virtual void operator++(void) override {
		--_index;
	};
	virtual bool Size(void) override {
		if (0 > _index)
			return false;
		return true;
	};
private:
	List* _list = nullptr;
	int _index = 0;
};

void main(void) {
	std::vector<int> _vector = { 0, 1 ,2 ,3, 4 };
	List* list = new List(_vector);

	Iterator* firstIterator = new FirstIterator(list);
	while (firstIterator->Size()) {
		std::cout << *(*firstIterator) << std::endl;
		++(*firstIterator);
	}

	Iterator* lastIterator = new LastIterator(list);
	while (lastIterator->Size()) {
		std::cout << *(*lastIterator) << std::endl;
		++(*lastIterator);
	}
};

```




> ## 추가
반복자는 외부 반복자와 내부 반복자로 나뉩니다.


